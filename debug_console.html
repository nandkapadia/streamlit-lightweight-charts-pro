<!DOCTYPE html>
<html>
<head>
    <title>Console Debug Capture</title>
    <script>
        // Override console methods to capture logs
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;

        let logBuffer = [];

        function captureLog(level, args) {
            const timestamp = new Date().toISOString();
            const message = Array.from(args).map(arg =>
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            logBuffer.push(`[${timestamp}] ${level.toUpperCase()}: ${message}`);

            // Also call original method
            if (level === 'log') originalLog.apply(console, args);
            else if (level === 'warn') originalWarn.apply(console, args);
            else if (level === 'error') originalError.apply(console, args);
        }

        console.log = function(...args) { captureLog('log', args); };
        console.warn = function(...args) { captureLog('warn', args); };
        console.error = function(...args) { captureLog('error', args); };

        // Export logs function
        window.exportLogs = function() {
            const logText = logBuffer.join('\n');
            const blob = new Blob([logText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'console-logs.txt';
            a.click();
            URL.revokeObjectURL(url);
        };

        // Auto-export after 10 seconds
        setTimeout(() => {
            if (logBuffer.length > 0) {
                console.log('Auto-exporting logs...');
                window.exportLogs();
            }
        }, 10000);
    </script>
</head>
<body>
    <h1>Console Debug Capture</h1>
    <p>This page captures console logs. Open the Streamlit app in another tab and come back here to download logs.</p>
    <button onclick="window.exportLogs()">Export Logs Now</button>
    <div id="logCount" style="margin-top: 20px;">Captured logs: 0</div>

    <script>
        // Update log count every second
        setInterval(() => {
            document.getElementById('logCount').textContent = `Captured logs: ${logBuffer.length}`;
        }, 1000);
    </script>
</body>
</html>